<!DOCTYPE html>
<html>
<head>
	<title>Exploitants en activités particulières au moyen d'aéronefs télé-pilotés</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!--CSS Leaflet*/-->
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
	<!--CSS Leaflet-MiniMap : https://github.com/Norkart/Leaflet-MiniMap-->
	<link rel="stylesheet" href="http://igeo.fr/leaflet/plugins/MiniMap/Control.MiniMap.css" />
	<!--CSS Leaflet.MousePosition : https://github.com/ardhi/Leaflet.MousePosition-->
	<link rel="stylesheet" href="http://igeo.fr/leaflet/plugins/MousePosition/L.Control.MousePosition.css" />
	<!--CSS Leaflet.GeoSearch : https://github.com/smeijer/L.GeoSearch-->
	<link rel="stylesheet" href="http://igeo.fr/leaflet/plugins/GeoSearch/css/l.geosearch.css" />
	<!--CSS Leaflet.MarkerCluster : https://github.com/Leaflet/Leaflet.markercluster -->
	<link rel="stylesheet" href="http://igeo.fr/leaflet/plugins/markercluster/MarkerCluster.css" />
	<link rel="stylesheet" href="http://igeo.fr/leaflet/plugins/markercluster/MarkerCluster.Default.css" />

  <style>
      body {
          padding: 0;
          margin: 0;
					background-color :#435a6b;
      }
      html, body, #map {
          height: 100%;
          width: 100%;
      }
  </style>
</head>


<body>
	<!--JS jquery -->
	<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>

	<!--JS Leaflet-->
	<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
	<!--JS Leaflet-MiniMap : https://github.com/Norkart/Leaflet-MiniMap-->
	<script src="http://igeo.fr/leaflet/plugins/MiniMap/Control.MiniMap.js" type="text/javascript"></script>
	<!--JS Leaflet.MousePosition : https://github.com/ardhi/Leaflet.MousePosition-->
	<script src="http://igeo.fr/leaflet/plugins/MousePosition/L.Control.MousePosition.js" type="text/javascript"></script>
	<!--JS Leaflet.GeoSearch : https://github.com/smeijer/L.GeoSearch-->
	<script src="http://igeo.fr/leaflet/plugins/GeoSearch/js/l.control.geosearch.js"></script>
	<script src="http://igeo.fr/leaflet/plugins/GeoSearch/js/l.geosearch.provider.openstreetmap.js"></script>
	<!--JS Leaflet.MarkerCluster : https://github.com/Leaflet/Leaflet.markercluster -->
	<script src="http://igeo.fr/leaflet/plugins/markercluster/leaflet.markercluster-src.js"></script>
	<!--JS Leaflet.heat https://github.com/Leaflet/Leaflet.heat-->
	<script src="http://igeo.fr/leaflet/plugins/Heat/dist/leaflet-heat.js"></script>

	<div id="map"></div>
	<script type="text/javascript">


	// IGN Géoportail Api Key
	//var ignApiKey = "" ;

	// IGN ORTHO
	//var orthoWmtsUrl	= "http://gpp3-wxs.ign.fr/"+ignApiKey + "/wmts?LAYER=ORTHOIMAGERY.ORTHOPHOTOS&EXCEPTIONS=text/xml&FORMAT=image/jpeg&SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&STYLE=normal&TILEMATRIXSET=PM&&TILEMATRIX={z}&TILECOL={x}&TILEROW={y}" ;
	//var ORTHO= L.tileLayer(orthoWmtsUrl, {attribution: '&copy; <a href="http://www.ign.fr/">IGN</a>'});

	// MapBox
	var mapbox   = L.tileLayer('https://b.tiles.mapbox.com/v3/examples.c7d2024a/{z}/{x}/{y}.png', {
	attribution: 'Map tiles by <a href="http://www.mapbox.com/">MapBox</a> &mdash; Map data &copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'});

	//Stamen
	var stamen = L.tileLayer('http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png', {
	attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
	subdomains: 'abcd',	minZoom: 0,	maxZoom: 20	});

	//MapQuest
	var MapQuestOpen_OSM = L.tileLayer('http://otile{s}.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.jpeg', {
	attribution: 'Tiles Courtesy of <a href="http://www.mapquest.com/">MapQuest</a> &mdash; Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
	subdomains: '1234'});

	//OSM
	var OpenStreetMap_Mapnik = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
	attribution: '&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'});

	var baseMap = {"Mapbox": mapbox, "Mapnik": OpenStreetMap_Mapnik,"MapQuest": MapQuestOpen_OSM,"Stamen Toner": stamen};

	//----------------------------------------------------------------------------------------------------------------

	var myIcon = L.icon({
								iconUrl: 'http://www.igeo.fr/map-icons/pins/32/pin2.png',
								iconSize: [24, 24],
								iconAnchor: [12, 24]
								});

//----------------------------------------------------------------------------------------------------------------

coords = []; //define an array to store coordinates

$.getJSON('20140918_exploitants.geojson', function(data) {
	var drone = L.geoJson(data, {
		onEachFeature: function (feature, layer) {
			var strfpdc = '';
				if (feature.properties.FPDC == 1) {
						strfpdc = '<a>Oui</a>';
				} else if (feature.properties.FPDC == 0) {
						strfpdc ='/';
				}
			var stragr = '';
 				if (feature.properties.AGR == 1) {
            stragr = '<a>Oui</a>';
        } else if (feature.properties.AGR == 0) {
            stragr ='/';
        }
			var strforagr = '';
				if (feature.properties.FOR_AGR == 1) {
						strforagr = '<a>Oui</a>';
				} else if (feature.properties.FOR_AGR == 0) {
						strforagr ='/';
				}
			var strlrg = '';
				if (feature.properties.LRG == 1) {
						strlrg = '<a>Oui</a>';
				} else if (feature.properties.LRG == 0) {
						strlrg ='/';
				}
			var strforlrg = '';
				if (feature.properties.FOR_LRG == 1) {
						strforlrg = '<a>Oui</a>';
				} else if (feature.properties.FOR_LRG == 0) {
						strforlrg ='/';
				}
			var strpub = '';
				if (feature.properties.PUB == 1) {
						strpub = '<a>Oui</a>';
				} else if (feature.properties.PUB == 0) {
						strpub ='/';
				}
			var strforpub = '';
				if (feature.properties.FOR_PUB == 1) {
						strforpub = '<a>Oui</a>';
				} else if (feature.properties.FOR_PUB == 0) {
						strforpub ='/';
				}
			var strobs = '';
				if (feature.properties.OBS == 1) {
						strobs = '<a>Oui</a>';
				} else if (feature.properties.OBS == 0) {
						strobs ='/';
				}
			var strforobs = '';
				if (feature.properties.FOR_OBS == 1) {
						strforobs = '<a>Oui</a>';
				} else if (feature.properties.FOR_OBS == 0) {
						strforobs ='/';
				}
			var straut = '';
				if (feature.properties.AUT == 1) {
						straut = '<a>Oui</a>';
				} else if (feature.properties.AUT == 0) {
						straut ='/';
				}
			var strforaut = '';
				if (feature.properties.FOR_AUT == 1) {
						strforaut = '<a>Oui</a>';
				} else if (feature.properties.FOR_AUT == 0) {
						strforaut ='/';
				}
//----------------------------------------------------------------------------------------------------------------

			var strs1= '';
				if (feature.properties.S1 == 1) {
						strs1 = '<a>Oui</a>';
				} else if (feature.properties.S1 == 0) {
						strs1 ='/';
				}
			var strs2 = '';
				if (feature.properties.S2 == 1) {
						strs2 = '<a>Oui</a>';
				} else if (feature.properties.S2 == 0) {
						strs2 ='/';
				}
			var strs3 = '';
				if (feature.properties.S3 == 1) {
						strs3 = '<a>Oui</a>';
				} else if (feature.properties.S3 == 0) {
						strs3 ='/';
				}
			var strs4 = '';
				if (feature.properties.S4 == 1) {
						strs4 = '<a>Oui</a>';
				} else if (feature.properties.S4 == 0) {
						strs4 ='/';
				}
			layer.bindPopup('<b><a style="color:red;">'+feature.properties.NOM +'</a></b>'+
			'<br>'+ feature.properties.CODE_P+'&nbsp;'+ feature.properties.VILLE+'&nbsp; - &nbsp;'+ feature.properties.PAYS+
			'<br><b>Site web : </b><a href=" ' + feature.properties.WEB + '">'+feature.properties.WEB +'</a>'+
			'<br><b>Activités :</b>'+
			'<br><table style="border:0px solid black; width:100%">'+
			'<tr><td>[AGR] : '+ stragr +'</td>'+
			'<td>[FOR-AGR] : '+ strforagr +'</td></tr>'+
			'<tr><td>[LRG] : '+ strlrg +'</td>'+
			'<td>[FOR-LRG] : '+ strforlrg +'</td></tr>'+
			'<tr><td>[PUB] : '+ strpub +'</td>'+
			'<td>[FOR-PUB] : '+ strforpub +'</td></tr>'+
			'<tr><td>[OBS] : '+ strobs +'</td>'+
			'<td>[FOR-OBS] : '+ strforobs +'</td></tr>'+
			'<tr><td>[AUT] : '+ straut+'</td>'+
			'<td>[FOR-AUT] : '+ strforaut +'</td></tr>'+
			'</table>'+
			'<b>Scénarios :</b>'+
			'<table style="border:0px solid black; width:100%">'+
			'<tr><td>[S1] : '+ strs1 +'</td>'+
			'<td>[S2] : '+ strs2 +'</td></tr>'+
			'<tr><td>[S3] : '+ strs3 +'</td>'+
			'<td>[S4] : '+ strs4 +'</td></tr>'+
			'</table>'+
			'<b>Adhérent à la FPDC :</b> '+ strfpdc
			//'<br><a style="color:red;"> Vérifié le : </a><a style="color:red;">'+feature.properties.VERIF +'</a>'

			);
			;
			layer.setIcon (layer.options.icon =myIcon);
			coords.push(L.GeoJSON.coordsToLatLng(feature.geometry.coordinates));
		}
	});

//----------------------------------------------------------------------------------------------------------------

	var markers = L.markerClusterGroup({spiderfyOnMaxZoom: false, showCoverageOnHover: true, zoomToBoundsOnClick: true, disableClusteringAtZoom: 13});
			markers.addLayer(drone);

//----------------------------------------------------------------------------------------------------------------

	var heat = L.heatLayer(coords, {maxZoom: 9,max:1, radius: 15,blur: 15, gradient: {
				0.0: "rgba(000,000,255,0)",
        0.2: "rgba(000,000,255,1)",
        0.4: "rgba(000,255,255,1)",
        0.6: "rgba(000,255,000,1)",
        0.8: "rgba(255,255,000,1)",
        1.0: "rgba(255,000,000,1)"}
	});


//----------------------------------------------------------------------------------------------------------------

	var overlays = {"Exploitants en activités particulières<br>au moyen d'aéronefs télé-pilotés 18/09/2014 <br>-> <a href =http://www.developpement-durable.gouv.fr/Quelle-place-pour-les-drones-dans.html>Pour en savoir plus</a>": markers,"Heatmap des exploitants en activités <br>particulières au moyen d'aéronefs télé-pilotés<br><br>-> <a href =https://github.com/igeofr/igeofr.github.io/edit/master/map_drones/>Contribuer et maintenir le fichier</a> <br>-> <a href =https://twitter.com/iGeoFlo>Signaler une erreur</a>":heat };

//----------------------------------------------------------------------------------------------------------------

	var map = new L.Map('map',
			{center: [46.5, 2.5],
			zoom: 6,
			layers: [mapbox,markers],
			maxZoom: 15
	});

	L.control.layers(baseMap,overlays,{ collapsed: true }).addTo(map);


//----------------------------------------------------------------------------------------------------------------

		//Mini Map
		var mapbox2 = new L.TileLayer('https://b.tiles.mapbox.com/v3/examples.c7d2024a/{z}/{x}/{y}.png');
		var miniMap = new L.Control.MiniMap(mapbox2, { toggleDisplay: true}).addTo(map);

//----------------------------------------------------------------------------------------------------------------

		//Mouse Position
		L.control.mousePosition().addTo(map);

//----------------------------------------------------------------------------------------------------------------

		//Scale
		L.control.scale({ position: 'bottomleft'}).addTo(map);

//----------------------------------------------------------------------------------------------------------------

		// GeoRecherche
		new L.Control.GeoSearch({
		    provider: new L.GeoSearch.Provider.OpenStreetMap(),
		    position: 'topcenter',
		    showMarker: false
		}).addTo(map);
//----------------------------------------------------------------------------------------------------------------

});


	</script>
</body>
</html>
